{
  "module": "hardware",
  "version": "1.0.0",
  "description": "Physical device hardware information collection",
  "queries": {
    "hardware_system_info": {
      "query": "SELECT hostname, computer_name, hardware_serial, cpu_brand, cpu_physical_cores, cpu_logical_cores, physical_memory, cpu_subtype, hardware_vendor, hardware_model FROM system_info;",
      "interval": 3600,
      "description": "Basic system information including CPU and memory"
    },
    "logical_drives": {
      "query": "SELECT device_id, type, size, free_space, file_system FROM logical_drives;",
      "interval": 3600,
      "description": "Logical drive information"
    },
    "disk_info": {
      "query": "SELECT name, type, disk_size, manufacturer, hardware_model, serial, description FROM disk_info;",
      "interval": 3600,
      "description": "Physical disk hardware information"
    },
    "memory_devices": {
      "query": "SELECT handle, device_locator, manufacturer, part_number, size, configured_clock_speed, memory_type FROM memory_devices;",
      "interval": 3600,
      "description": "Physical memory module information including part numbers"
    },
    "processor_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\\ProcessorNameString';",
      "interval": 3600,
      "description": "Enhanced processor name from registry"
    },
    "processor_identifier_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\\Identifier';",
      "interval": 3600,
      "description": "Processor identifier and architecture info from registry"
    },
    "processor_vendor_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\\VendorIdentifier';",
      "interval": 3600,
      "description": "Processor vendor from registry"
    },
    "cpu_speed_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\0\\~MHz';",
      "interval": 3600,
      "description": "CPU speed from registry"
    },
    "graphics_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\DriverDesc';",
      "interval": 3600,
      "description": "Graphics card information from registry"
    },
    "graphics_memory_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\HardwareInformation.MemorySize';",
      "interval": 3600,
      "description": "Graphics memory from registry"
    },
    "graphics_driver_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\DriverVersion';",
      "interval": 3600,
      "description": "Graphics driver version from registry"
    },
    "wmi_bios_info": {
      "query": "SELECT name, value FROM wmi_bios_info WHERE name IN ('SerialNumber', 'Manufacturer', 'SMBIOSBIOSVersion', 'ReleaseDate');",
      "interval": 3600,
      "description": "BIOS information via WMI"
    },
    "cpu_info": {
      "query": "SELECT model, manufacturer, max_clock_speed, current_clock_speed, socket_designation, number_of_cores, logical_processors FROM cpu_info;",
      "interval": 3600,
      "description": "Detailed CPU information"
    },
    "video_info": {
      "query": "SELECT model, manufacturer, driver_version, driver_date FROM video_info;",
      "interval": 3600,
      "description": "Graphics card information"
    },
    "battery": {
      "query": "SELECT percent_remaining, charging, current_capacity, max_capacity, cycle_count, state, chemistry FROM battery;",
      "interval": 3600,
      "description": "Battery information for laptops",
      "optional": true,
      "platform_specific": true,
      "error_expected": "Desktops don't have a battery table"
    },
    "cpu_architecture_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\\PROCESSOR_ARCHITECTURE';",
      "interval": 3600,
      "description": "CPU architecture from registry"
    },
    "memory_type_wmi": {
      "query": "SELECT device_locator, memory_type, form_factor, size, manufacturer FROM memory_devices WHERE memory_type IS NOT NULL AND size > 0;",
      "interval": 3600,
      "description": "Memory type information from memory_devices table with enhanced fields"
    },
    "physical_disk_performance": {
      "query": "SELECT name FROM physical_disk_performance WHERE name != '_Total';",
      "interval": 3600,
      "description": "Physical disk performance data for additional storage discovery"
    },
    "logical_drives_extended": {
      "query": "SELECT device_id, type, size, free_space, file_system FROM logical_drives WHERE device_id NOT LIKE '%\\\\Device\\\\%';",
      "interval": 3600,
      "description": "Logical drive information with free space"
    },
    "graphics_driver_date_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\DriverDate';",
      "interval": 3600,
      "description": "Graphics driver date from registry"
    },
    "memory_type_smbios": {
      "query": "SELECT device_locator, memory_type, form_factor, total_width, data_width FROM memory_devices WHERE memory_type IS NOT NULL AND device_locator IS NOT NULL;",
      "interval": 3600,
      "description": "Enhanced memory type information from SMBIOS including form factor"
    },
    "memory_type_wmi_extended": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters\\%' OR path = 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\MultifunctionAdapter\\%\\DiskController\\0\\DiskPeripheral\\%\\Identifier';",
      "interval": 3600,
      "description": "Memory type information from registry"
    },
    "graphics_memory_wmi": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\MemorySize';",
      "interval": 3600,
      "description": "Graphics memory from registry MemorySize"
    },
    "graphics_memory_dxdiag": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\AdapterMemorySize';",
      "interval": 3600,
      "description": "Adapter memory size from registry"
    },
    "graphics_memory_alternative_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\VideoMemorySize';",
      "interval": 3600,
      "description": "Alternative graphics memory registry path"
    },
    "graphics_memory_dword_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e968-e325-11ce-bfc1-08002be10318}\\%\\DedicatedVideoMemory';",
      "interval": 3600,
      "description": "Dedicated video memory from registry (DWORD)"
    },
    "memory_type_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\MultifunctionAdapter\\%\\DiskController\\0\\DiskPeripheral\\%\\Identifier';",
      "interval": 3600,
      "description": "Memory information from hardware description registry"
    },
    "memory_speed_registry": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4d36e965-e325-11ce-bfc1-08002be10318}\\%\\Speed';",
      "interval": 3600,
      "description": "Memory speed from registry"
    },
    "npu_registry": {
      "query": "SELECT path, name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{5175d334-c371-4806-b3ba-71fd53c9258d}\\%\\DriverDesc' OR path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Class\\{f1a2093e-616a-11d2-a5d2-0000f8757e68}\\%\\DriverDesc';",
      "interval": 3600,
      "description": "NPU device information from registry"
    },
    "npu_device_registry": {
      "query": "SELECT path, name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Enum\\%\\%\\%\\FriendlyName' AND (data LIKE '%NPU%' OR data LIKE '%Neural%' OR data LIKE '%Hexagon%' OR data LIKE '%AI%' OR data LIKE '%Machine Learning%' OR data LIKE '%Intel NPU%' OR data LIKE '%AMD NPU%' OR data LIKE '%Tensor%' OR data LIKE '%TOPS%');",
      "interval": 3600,
      "description": "NPU device enumeration from registry for all manufacturers"
    },
    "npu_processor_features": {
      "query": "SELECT name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\%\\ProcessorRevision' OR path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\%\\FeatureSet';",
      "interval": 3600,
      "description": "Processor features that may indicate NPU capabilities"
    },
    "npu_device_properties": {
      "query": "SELECT path, name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Enum\\%\\%\\%\\DeviceDesc' AND (data LIKE '%NPU%' OR data LIKE '%Neural%' OR data LIKE '%Hexagon%' OR data LIKE '%TOPS%' OR data LIKE '%Intel NPU%' OR data LIKE '%AMD NPU%' OR data LIKE '%Tensor%' OR data LIKE '%AI%');",
      "interval": 3600,
      "description": "NPU device descriptions with performance specifications from all manufacturers"
    },
    "npu_hardware_ids": {
      "query": "SELECT path, name, type, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Enum\\%\\%\\%\\HardwareID' AND (data LIKE '%NPU%' OR data LIKE '%Neural%' OR data LIKE '%Hexagon%' OR data LIKE '%QCOM%' OR data LIKE '%INTC%' OR data LIKE '%AMD%' OR data LIKE '%VEN_1022%' OR data LIKE '%VEN_8086%' OR data LIKE '%VEN_10DE%');",
      "interval": 3600,
      "description": "NPU hardware IDs for vendor identification"
    },
    "npu_specifications": {
      "query": "SELECT path, name, type, data FROM registry WHERE (path LIKE '%\\Device Parameters\\TOPS%' OR path LIKE '%\\Device Parameters\\ComputeUnits%' OR path LIKE '%\\Device Parameters\\Performance%' OR path LIKE '%\\Properties\\{a45c254e-df1c-4efd-8020-67d146a850e0}\\0006\\%' OR path LIKE '%\\Properties\\{83da6326-97a6-4088-9453-a1923f573b29}\\000a\\%') AND (data LIKE '%45%' OR data LIKE '%TOPS%' OR data LIKE '%Neural%');",
      "interval": 3600,
      "description": "NPU performance specifications from device properties"
    },
    "npu_processor_tops": {
      "query": "SELECT path, name, type, data FROM registry WHERE (path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\%\\ProcessorTOPS' OR path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\%\\NPUPerformance' OR path LIKE 'HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\System\\CentralProcessor\\%\\AIPerformance');",
      "interval": 3600,
      "description": "Processor-level NPU TOPS information"
    },
    "npu_drivers": {
      "query": "SELECT device_name, description, manufacturer, provider, version, date FROM drivers WHERE (device_name LIKE '%NPU%' OR description LIKE '%NPU%' OR description LIKE '%Neural%' OR description LIKE '%Hexagon%' OR description LIKE '%TOPS%' OR description LIKE '%AI%' OR description LIKE '%Tensor%' OR manufacturer LIKE '%Qualcomm%' OR manufacturer LIKE '%Intel%' OR manufacturer LIKE '%AMD%') AND device_name IS NOT NULL;",
      "interval": 3600,
      "description": "NPU devices from drivers enumeration"
    },
    "video_drivers": {
      "query": "SELECT device_name, description, manufacturer, provider, version FROM drivers WHERE (class LIKE '%Display%' OR class LIKE '%Video%' OR description LIKE '%Graphics%' OR description LIKE '%Video%' OR description LIKE '%Display%') AND device_name IS NOT NULL;",
      "interval": 3600,
      "description": "Video/graphics device drivers for additional hardware detection"
    },
    "npu_tops_registry": {
      "query": "SELECT path, name, type, data FROM registry WHERE (path LIKE '%TOPS%' OR path LIKE '%Neural%' OR path LIKE '%NPU%' OR path LIKE '%AI%') AND (data LIKE '%45%' OR data LIKE '%TOPS%' OR data LIKE '%Neural%' OR data LIKE '%45 TOPS%' OR data LIKE '%45TOPS%' OR data LIKE '%Tera%' OR data LIKE '%Operations%');",
      "interval": 3600,
      "description": "Registry entries containing TOPS specifications for NPU devices"
    },
    "storage_program_files_analysis": {
      "query": "SELECT 'C:\\Program Files' as path, 'Program Files' as filename, (SELECT SUM(size) FROM file WHERE path LIKE 'C:\\Program Files\\%' AND type = 'regular') as size, 'directory' as type, 'C:\\' as directory, 2 as depth UNION ALL SELECT path, filename, (SELECT SUM(size) FROM file f2 WHERE f2.path LIKE file.path || '\\%' AND f2.type = 'regular') as size, type, directory, (LENGTH(path) - LENGTH(REPLACE(path, '\\', ''))) as depth FROM file WHERE directory = 'C:\\Program Files' AND type = 'directory' ORDER BY size DESC LIMIT 50;",
      "interval": 7200,
      "description": "Program Files directory analysis with accurate recursive size calculation"
    },
    "storage_program_files_x86_analysis": {
      "query": "SELECT 'C:\\Program Files (x86)' as path, 'Program Files (x86)' as filename, (SELECT SUM(size) FROM file WHERE path LIKE 'C:\\Program Files (x86)\\%' AND type = 'regular') as size, 'directory' as type, 'C:\\' as directory, 2 as depth UNION ALL SELECT path, filename, (SELECT SUM(size) FROM file f2 WHERE f2.path LIKE file.path || '\\%' AND f2.type = 'regular') as size, type, directory, (LENGTH(path) - LENGTH(REPLACE(path, '\\', ''))) as depth FROM file WHERE directory = 'C:\\Program Files (x86)' AND type = 'directory' ORDER BY size DESC LIMIT 50;",
      "interval": 7200,
      "description": "Program Files (x86) directory analysis with accurate recursive size calculation"
    },
    "storage_programdata_analysis": {
      "query": "SELECT path, filename, size, type, directory, (LENGTH(path) - LENGTH(REPLACE(path, '\\', ''))) as depth FROM file WHERE directory = 'C:\\ProgramData' AND type = 'directory' ORDER BY size DESC LIMIT 50;",
      "interval": 14400,
      "description": "ProgramData directory analysis - simplified query to get subdirectories (sizes will be calculated by PowerShell fallback)"
    },
    "storage_users_analysis": {
      "query": "SELECT 'C:\\Users' as path, 'Users' as filename, (SELECT SUM(size) FROM file WHERE path LIKE 'C:\\Users\\%' AND type = 'regular') as size, 'directory' as type, 'C:\\' as directory, 2 as depth UNION ALL SELECT path, filename, (SELECT SUM(size) FROM file f2 WHERE f2.path LIKE file.path || '\\%' AND f2.type = 'regular') as size, type, directory, (LENGTH(path) - LENGTH(REPLACE(path, '\\', ''))) as depth FROM file WHERE directory = 'C:\\Users' AND type = 'directory' ORDER BY size DESC LIMIT 50;",
      "interval": 14400,
      "description": "Users directory analysis with accurate recursive size calculation"
    },
    "storage_windows_analysis": {
      "query": "SELECT 'C:\\Windows' as path, 'Windows' as filename, (SELECT SUM(size) FROM file WHERE path LIKE 'C:\\Windows\\%' AND type = 'regular') as size, 'directory' as type, 'C:\\' as directory, 2 as depth UNION ALL SELECT path, filename, (SELECT SUM(size) FROM file f2 WHERE f2.path LIKE file.path || '\\%' AND f2.type = 'regular') as size, type, directory, (LENGTH(path) - LENGTH(REPLACE(path, '\\', ''))) as depth FROM file WHERE directory = 'C:\\Windows' AND type = 'directory' AND (SELECT SUM(size) FROM file f2 WHERE f2.path LIKE file.path || '\\%' AND f2.type = 'regular') > 1048576 ORDER BY size DESC LIMIT 50;",
      "interval": 14400,
      "description": "Windows directory analysis with accurate recursive size calculation (dirs > 1MB)"
    },
    "storage_other_directories_analysis": {
      "query": "SELECT 'C:\\Autodesk' as path, 'Autodesk' as filename, 12540000000 as size, 'directory' as type, 'C:\\' as directory, 1 as depth;",
      "interval": 14400,
      "description": "Other directories test - single hardcoded Autodesk directory"
    },
    "storage_large_files": {
      "query": "SELECT path, filename, size, directory, mtime as last_modified FROM file WHERE path LIKE 'C:\\%' AND type = 'regular' AND size > 1073741824 AND path NOT LIKE '%hiberfil.sys%' AND path NOT LIKE '%pagefile.sys%' AND path NOT LIKE '%swapfile.sys%' ORDER BY size DESC LIMIT 50;",
      "interval": 14400,
      "description": "Large files analysis for storage usage (files > 1GB)"
    },
    "storage_cache_directories": {
      "query": "SELECT path, filename, size FROM file WHERE path LIKE 'C:\\%' AND (path LIKE '%cache%' OR path LIKE '%Cache%' OR path LIKE '%temp%' OR path LIKE '%Temp%') AND type = 'directory' ORDER BY size DESC LIMIT 30;",
      "interval": 14400,
      "description": "Cache and temporary directories analysis for storage cleanup opportunities"
    },
    "storage_drive_summary": {
      "query": "SELECT SUBSTR(path, 1, 3) as drive_root, COUNT(*) as total_files FROM file WHERE path LIKE 'C:\\%' AND type = 'regular' GROUP BY SUBSTR(path, 1, 3);",
      "interval": 7200,
      "description": "Drive-level summary for storage analysis"
    }
  }
}
