{
  "module": "network",
  "version": "2.0.0",
  "description": "Enhanced network connectivity and configuration with active connection detection",
  "queries": {
    "interface_addresses": {
      "query": "SELECT interface, address, mask FROM interface_addresses WHERE address NOT LIKE '169.254.%' AND address NOT LIKE '127.%' AND interface NOT LIKE '%Loopback%';",
      "interval": 600,
      "description": "Primary network interface IP addresses"
    },
    "interface_details": {
      "query": "SELECT interface, mac, type, enabled, mtu FROM interface_details WHERE interface NOT LIKE '%Loopback%' AND mac != '';",
      "interval": 600,
      "description": "Essential network interface details including MTU"
    },
    "interface_names": {
      "query": "SELECT path AS interface_path, key AS interface_key, data AS friendly_name FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\%\\Connection' AND key = 'Name';",
      "interval": 600,
      "description": "Friendly names for network interfaces from registry"
    },
    "active_connections": {
      "query": "SELECT DISTINCT interface FROM interface_addresses WHERE address NOT LIKE '169.254.%' AND address NOT LIKE '127.%' AND address NOT LIKE 'fe80::%' AND interface NOT LIKE '%Loopback%';",
      "interval": 300,
      "description": "Currently active network interfaces with valid IP addresses"
    },
    "routes": {
      "query": "SELECT destination, gateway, interface, metric FROM routes WHERE destination = '0.0.0.0' OR destination LIKE '10.%' OR destination LIKE '192.168.%' OR destination LIKE '172.1%.%';",
      "interval": 600,
      "description": "Essential routing information (default gateway and private networks)"
    },
    "vpn_services": {
      "query": "SELECT display_name, status FROM services WHERE display_name LIKE '%VPN%' OR display_name LIKE '%L2TP%' OR display_name LIKE '%PPTP%' OR display_name LIKE '%Cisco%' OR display_name LIKE '%AnyConnect%' OR display_name LIKE '%OpenVPN%' OR display_name LIKE '%WireGuard%' OR display_name LIKE '%NordVPN%' OR display_name LIKE '%ExpressVPN%' OR display_name LIKE '%Surfshark%';",
      "interval": 600,
      "description": "Active VPN services - comprehensive coverage"
    },
    "vpn_interfaces": {
      "query": "SELECT interface, enabled FROM interface_details WHERE interface LIKE '%VPN%' OR interface LIKE '%L2TP%' OR interface LIKE '%PPTP%' OR interface LIKE '%WAN%' OR interface LIKE '%TAP%' OR interface LIKE '%TUN%' OR interface LIKE '%Cisco%' OR interface LIKE '%OpenVPN%' OR interface LIKE '%WireGuard%' OR type IN ('53', '131');",
      "interval": 600,
      "description": "VPN network interfaces - comprehensive coverage"
    },
    "vpn_connections": {
      "query": "SELECT interface, address FROM interface_addresses WHERE interface LIKE '%VPN%' OR interface LIKE '%L2TP%' OR interface LIKE '%PPTP%' OR interface LIKE '%WAN%' OR interface LIKE '%TAP%' OR interface LIKE '%TUN%';",
      "interval": 600,
      "description": "Active VPN connection IP addresses"
    },
    "system_info": {
      "query": "SELECT hostname, uuid FROM system_info;",
      "interval": 3600,
      "description": "System hostname information for network module"
    },
    "environment_variables": {
      "query": "SELECT variable as name, value FROM default_environment WHERE variable IN ('COMPUTERNAME', 'USERDOMAIN', 'USERDNSDOMAIN');",
      "interval": 3600,
      "description": "Computer name and domain information from environment variables"
    },
    "dns_settings": {
      "query": "SELECT path, key, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters' AND key IN ('Domain', 'DhcpDomain', 'SearchList', 'DhcpDNS', 'NameServer');",
      "interval": 600,
      "description": "DNS configuration from registry including search domains"
    },
    "netbios_settings": {
      "query": "SELECT path, key, data FROM registry WHERE path LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters' AND key IN ('EnableLMHosts', 'NodeType', 'ScopeID');",
      "interval": 600,
      "description": "NETBIOS configuration settings from registry"
    }
  }
}
